# wildberries_tg_bot

## Технологии

- Python 3.9
- aiogram
- alembic
- asyncpg
- pydantic-settings
- python-dotenv
- requests
- PostgreSQL
- SQLAlchemy
- Docker
- Docker-compose

### Доступный функционал

- Меню состоящее из 3 кнопок: «Получить информацию по товару», «Остановить уведомления», «получить информацию из БД».
- Нажимая на кнопку «Получить информацию по товару» Пользователь отправляет в бота артикул товара с Wildsberries (например: 211695539).
- Бот выдаёт информацию о товаре (карточке) - Название, артикул, цена, рейтинг товара, количество товара НА ВСЕХ СКЛАДАХ.
- Под сообщением, которые присылает бот есть inline-кнопка - «подписаться». По нажатию на которую приходят уведомления в бот каждые 5 минут с сообщением, что было выше. (Название, артикул, цена, рейтинг товара, количество товара НА ВСЕХ СКЛАДАХ).
- При нажатии на кнопку «Остановить уведомления» - уведомления останавливаются.
- При нажатии на кнопку «получить информацию из БД» бот присылает сообщение с последними 5 записями из БД.

### Как запустить проект

Клонируйте репозиторий и перейдите к нему в командной строке:

    git clone git@github.com:smoke-m/wildberries_tg_bot.git

    cd wildberries_tg_bot

Создайте и активируйте venv:

    python -m venv env
    source venv/Scripts/activate

Установите зависимости из файла requirements.txt:

    python -m pip install --upgrade pip
    pip install -r requirements.txt

Выполните миграции:

    alembic upgrade head

Запустите проект:

    python bot.py

Зеркало на hub.docker.com:

    puzzzo/tg_bot_api_wb

Выполните миграции для docker:

    docker compose -f docker-compose.production.yml exec bot alembic upgrade head

#### Pre-commit
Для минимизации трудностей во время разработки и поддержании высокого качества кода в разработке мы используем `pre-commit`. Данный фреймворк позволяет проверить код на соответствие `PEP8`, защитить ветки master и develop от непреднамеренного коммита, проверить корректность импортов и наличие trailing spaces.
`Pre-commit` конфигурируется с помощью специального файл `.pre-commit-config.yaml`. Для использования фреймворка его необходимо установить, выполнив команду из активированного виртуального окружения:

```bash
(venv)$ pip install pre-commit
```
или 

```bash
(venv)$ pip install -r requirements-dev.txt
```
Для принудительной проверки всех файлов можно выполнить команду:
```bash
(venv)$ pre-commit run --all-files
```
При первом запуске будут скачаны и установлены все необходимые хуки, указанные в конфигурационном файле.

Для автоматической проверки всех файлов необходимо инициализировать фреймворк командой:
```bash
(venv)$ pre-commit install
```